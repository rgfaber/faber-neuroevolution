<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 500" font-family="system-ui, -apple-system, sans-serif">
  <defs>
    <linearGradient id="l2Grad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#a78bfa;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#8b5cf6;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="l1Grad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#60a5fa;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#3b82f6;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="l0Grad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#4ade80;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#22c55e;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.2"/>
    </filter>
    <marker id="arrowDown" markerWidth="10" markerHeight="7" refX="5" refY="7" orient="auto">
      <polygon points="0 0, 10 0, 5 7" fill="#64748b" />
    </marker>
    <marker id="arrowUp" markerWidth="10" markerHeight="7" refX="5" refY="0" orient="auto">
      <polygon points="0 7, 10 7, 5 0" fill="#f97316" />
    </marker>
  </defs>

  <!-- Background -->
  <rect width="800" height="500" fill="#f8fafc"/>

  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" font-size="22" font-weight="bold" fill="#1e293b">Hierarchical Learning Cascade</text>
  <text x="400" y="50" text-anchor="middle" font-size="12" fill="#64748b">How Each Level Learns in the Liquid Conglomerate Architecture</text>

  <!-- L2 Section -->
  <g transform="translate(50, 70)">
    <rect x="0" y="0" width="700" height="110" rx="12" fill="white" stroke="#8b5cf6" stroke-width="2" filter="url(#shadow)"/>
    <rect x="0" y="0" width="700" height="35" rx="12" fill="url(#l2Grad)"/>
    <rect x="0" y="23" width="700" height="12" fill="url(#l2Grad)"/>
    <text x="20" y="25" font-size="14" font-weight="bold" fill="white">L2: Strategic Layer</text>
    <text x="680" y="25" text-anchor="end" font-size="11" fill="white" opacity="0.9">τ = 5 min (Resource) / 10K evals (Task)</text>

    <!-- L2 Learning Box -->
    <g transform="translate(20, 45)">
      <rect x="0" y="0" width="200" height="55" rx="6" fill="#ede9fe" stroke="#a78bfa"/>
      <text x="100" y="18" text-anchor="middle" font-size="11" font-weight="600" fill="#5b21b6">What L2 Learns</text>
      <text x="100" y="33" text-anchor="middle" font-size="9" fill="#5b21b6">How to tune L1's hyperparameters</text>
      <text x="100" y="46" text-anchor="middle" font-size="9" fill="#5b21b6">for long-term L0 performance</text>
    </g>

    <!-- L2 Mechanism -->
    <g transform="translate(240, 45)">
      <rect x="0" y="0" width="200" height="55" rx="6" fill="#f5f3ff" stroke="#c4b5fd"/>
      <text x="100" y="18" text-anchor="middle" font-size="11" font-weight="600" fill="#5b21b6">Learning Mechanism</text>
      <text x="100" y="33" text-anchor="middle" font-size="9" fill="#5b21b6">Slow exploration strategy</text>
      <text x="100" y="46" text-anchor="middle" font-size="9" fill="#5b21b6">3-5 variants, best-so-far tracking</text>
    </g>

    <!-- L2 Fitness -->
    <g transform="translate(460, 45)">
      <rect x="0" y="0" width="220" height="55" rx="6" fill="#faf5ff" stroke="#d8b4fe"/>
      <text x="110" y="18" text-anchor="middle" font-size="11" font-weight="600" fill="#5b21b6">Fitness Signal</text>
      <text x="110" y="33" text-anchor="middle" font-size="9" fill="#5b21b6">Cumulative L0 reward over</text>
      <text x="110" y="46" text-anchor="middle" font-size="9" fill="#5b21b6">many L1 adjustment cycles</text>
    </g>
  </g>

  <!-- Down Arrow L2 to L1 -->
  <g transform="translate(400, 175)">
    <path d="M 0 0 L 0 25" stroke="#8b5cf6" stroke-width="3" marker-end="url(#arrowDown)"/>
    <text x="15" y="15" font-size="10" fill="#8b5cf6">L1 Hyperparams</text>
  </g>

  <!-- L1 Section -->
  <g transform="translate(50, 210)">
    <rect x="0" y="0" width="700" height="110" rx="12" fill="white" stroke="#3b82f6" stroke-width="2" filter="url(#shadow)"/>
    <rect x="0" y="0" width="700" height="35" rx="12" fill="url(#l1Grad)"/>
    <rect x="0" y="23" width="700" height="12" fill="url(#l1Grad)"/>
    <text x="20" y="25" font-size="14" font-weight="bold" fill="white">L1: Tactical Layer</text>
    <text x="680" y="25" text-anchor="end" font-size="11" fill="white" opacity="0.9">τ = 30s (Resource) / 5K evals (Task)</text>

    <!-- L1 Learning Box -->
    <g transform="translate(20, 45)">
      <rect x="0" y="0" width="200" height="55" rx="6" fill="#dbeafe" stroke="#93c5fd"/>
      <text x="100" y="18" text-anchor="middle" font-size="11" font-weight="600" fill="#1e40af">What L1 Learns</text>
      <text x="100" y="33" text-anchor="middle" font-size="9" fill="#1e40af">Optimal L0 hyperparameters</text>
      <text x="100" y="46" text-anchor="middle" font-size="9" fill="#1e40af">for current conditions</text>
    </g>

    <!-- L1 Mechanism -->
    <g transform="translate(240, 45)">
      <rect x="0" y="0" width="200" height="55" rx="6" fill="#eff6ff" stroke="#bfdbfe"/>
      <text x="100" y="18" text-anchor="middle" font-size="11" font-weight="600" fill="#1e40af">Learning Mechanism</text>
      <text x="100" y="33" text-anchor="middle" font-size="9" fill="#1e40af">Meta-evolution (TWEANN)</text>
      <text x="100" y="46" text-anchor="middle" font-size="9" fill="#1e40af">5-10 variants, performance-based</text>
    </g>

    <!-- L1 Fitness -->
    <g transform="translate(460, 45)">
      <rect x="0" y="0" width="220" height="55" rx="6" fill="#f0f9ff" stroke="#e0f2fe"/>
      <text x="110" y="18" text-anchor="middle" font-size="11" font-weight="600" fill="#1e40af">Fitness Signal</text>
      <text x="110" y="33" text-anchor="middle" font-size="9" fill="#1e40af">How well L0 performs under</text>
      <text x="110" y="46" text-anchor="middle" font-size="9" fill="#1e40af">each hyperparameter regime</text>
    </g>
  </g>

  <!-- Down Arrow L1 to L0 -->
  <g transform="translate(400, 315)">
    <path d="M 0 0 L 0 25" stroke="#3b82f6" stroke-width="3" marker-end="url(#arrowDown)"/>
    <text x="15" y="15" font-size="10" fill="#3b82f6">L0 Hyperparams</text>
  </g>

  <!-- L0 Section -->
  <g transform="translate(50, 350)">
    <rect x="0" y="0" width="700" height="110" rx="12" fill="white" stroke="#22c55e" stroke-width="2" filter="url(#shadow)"/>
    <rect x="0" y="0" width="700" height="35" rx="12" fill="url(#l0Grad)"/>
    <rect x="0" y="23" width="700" height="12" fill="url(#l0Grad)"/>
    <text x="20" y="25" font-size="14" font-weight="bold" fill="white">L0: Reactive Layer</text>
    <text x="680" y="25" text-anchor="end" font-size="11" fill="white" opacity="0.9">τ = 5s (Resource) / 1K evals (Task)</text>

    <!-- L0 Learning Box -->
    <g transform="translate(20, 45)">
      <rect x="0" y="0" width="200" height="55" rx="6" fill="#dcfce7" stroke="#86efac"/>
      <text x="100" y="18" text-anchor="middle" font-size="11" font-weight="600" fill="#166534">What L0 Learns</text>
      <text x="100" y="33" text-anchor="middle" font-size="9" fill="#166534">Sensor → Actuator mappings</text>
      <text x="100" y="46" text-anchor="middle" font-size="9" fill="#166534">Optimal reactions to state</text>
    </g>

    <!-- L0 Mechanism -->
    <g transform="translate(240, 45)">
      <rect x="0" y="0" width="200" height="55" rx="6" fill="#f0fdf4" stroke="#bbf7d0"/>
      <text x="100" y="18" text-anchor="middle" font-size="11" font-weight="600" fill="#166534">Learning Mechanism</text>
      <text x="100" y="33" text-anchor="middle" font-size="9" fill="#166534">Direct neuroevolution (TWEANN)</text>
      <text x="100" y="46" text-anchor="middle" font-size="9" fill="#166534">Population-based, topology+weights</text>
    </g>

    <!-- L0 Fitness -->
    <g transform="translate(460, 45)">
      <rect x="0" y="0" width="220" height="55" rx="6" fill="#f7fee7" stroke="#d9f99d"/>
      <text x="110" y="18" text-anchor="middle" font-size="11" font-weight="600" fill="#166534">Fitness Signal</text>
      <text x="110" y="33" text-anchor="middle" font-size="9" fill="#166534">Domain-specific reward</text>
      <text x="110" y="46" text-anchor="middle" font-size="9" fill="#166534">(throughput, improvement, balance)</text>
    </g>
  </g>

  <!-- Feedback arrows (right side) -->
  <g transform="translate(770, 180)">
    <path d="M 0 200 L 0 0" stroke="#f97316" stroke-width="2" stroke-dasharray="4,2" marker-end="url(#arrowUp)"/>
    <text x="-80" y="100" transform="rotate(-90 -80 100)" font-size="10" fill="#f97316">Performance Feedback</text>
  </g>

  <!-- Key insight box -->
  <g transform="translate(100, 470)">
    <rect x="0" y="0" width="600" height="25" rx="4" fill="#fef3c7" stroke="#fbbf24"/>
    <text x="300" y="16" text-anchor="middle" font-size="11" fill="#92400e">Key Insight: Each level provides a stable platform for the level below to learn on</text>
  </g>
</svg>
