<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 850 520">
  <defs>
    <linearGradient id="resGrad2" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#60a5fa"/>
      <stop offset="100%" style="stop-color:#3b82f6"/>
    </linearGradient>
    <linearGradient id="diseaseGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f87171"/>
      <stop offset="100%" style="stop-color:#ef4444"/>
    </linearGradient>
    <linearGradient id="catGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f97316"/>
      <stop offset="100%" style="stop-color:#ea580c"/>
    </linearGradient>
    <linearGradient id="cycleGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#a78bfa"/>
      <stop offset="100%" style="stop-color:#8b5cf6"/>
    </linearGradient>
    <filter id="shadowDyn" x="-10%" y="-10%" width="120%" height="120%">
      <feDropShadow dx="2" dy="2" stdDeviation="2" flood-opacity="0.2"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="850" height="520" fill="#f8fafc"/>

  <!-- Title -->
  <text x="425" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#1e293b">Ecological Dynamics: Resources, Disease, Catastrophe &amp; Cycles</text>

  <!-- Resource Dynamics Section -->
  <rect x="40" y="55" width="260" height="200" rx="10" fill="white" stroke="#3b82f6" stroke-width="2" filter="url(#shadowDyn)"/>
  <rect x="40" y="55" width="260" height="30" rx="10" fill="url(#resGrad2)"/>
  <rect x="40" y="75" width="260" height="10" fill="url(#resGrad2)"/>
  <text x="170" y="77" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Resource Dynamics</text>

  <!-- Resource level bar -->
  <text x="55" y="110" font-family="Arial, sans-serif" font-size="10" fill="#1e40af">Resource Level:</text>
  <rect x="55" y="115" width="230" height="20" fill="#e5e7eb" stroke="#9ca3af" rx="3"/>
  <rect x="55" y="115" width="161" height="20" fill="#3b82f6" rx="3"/>
  <text x="125" y="130" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">70%</text>

  <!-- Carrying capacity -->
  <text x="55" y="155" font-family="Arial, sans-serif" font-size="10" fill="#1e40af">Carrying Capacity:</text>
  <rect x="55" y="160" width="230" height="15" fill="#dcfce7" stroke="#22c55e" rx="2"/>
  <line x1="220" y1="160" x2="220" y2="175" stroke="#ef4444" stroke-width="2"/>
  <text x="222" y="172" font-family="Arial, sans-serif" font-size="8" fill="#ef4444">cap</text>
  <rect x="55" y="160" width="195" height="15" fill="#22c55e" rx="2"/>
  <text x="140" y="171" font-family="Arial, sans-serif" font-size="8" fill="white">Population: 85%</text>

  <text x="55" y="195" font-family="Arial, sans-serif" font-size="9" fill="#1e40af">Regeneration: 0.05/gen</text>
  <text x="55" y="210" font-family="Arial, sans-serif" font-size="9" fill="#1e40af">Decay: 0.03/gen</text>
  <text x="55" y="230" font-family="monospace" font-size="8" fill="#3b82f6">overflow_penalty = 0.1 * (density - 1.0)</text>
  <text x="55" y="245" font-family="Arial, sans-serif" font-size="9" fill="#dc2626">Near capacity: -10% fitness</text>

  <!-- Disease Section -->
  <rect x="320" y="55" width="220" height="200" rx="10" fill="white" stroke="#ef4444" stroke-width="2" filter="url(#shadowDyn)"/>
  <rect x="320" y="55" width="220" height="30" rx="10" fill="url(#diseaseGrad)"/>
  <rect x="320" y="75" width="220" height="10" fill="url(#diseaseGrad)"/>
  <text x="430" y="77" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Disease System</text>

  <!-- Disease spread diagram -->
  <circle cx="360" cy="130" r="12" fill="#fee2e2" stroke="#ef4444" stroke-width="2"/>
  <text x="360" y="134" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#dc2626">P0</text>

  <line x1="372" y1="130" x2="390" y2="115" stroke="#ef4444" stroke-width="1.5" stroke-dasharray="3,2"/>
  <line x1="372" y1="130" x2="390" y2="130" stroke="#ef4444" stroke-width="1.5" stroke-dasharray="3,2"/>
  <line x1="372" y1="130" x2="390" y2="145" stroke="#ef4444" stroke-width="1.5" stroke-dasharray="3,2"/>

  <circle cx="405" cy="115" r="10" fill="#fecaca" stroke="#ef4444" stroke-width="1"/>
  <circle cx="405" cy="130" r="10" fill="#fecaca" stroke="#ef4444" stroke-width="1"/>
  <circle cx="405" cy="145" r="10" fill="#fecaca" stroke="#ef4444" stroke-width="1"/>

  <circle cx="460" cy="115" r="10" fill="#dcfce7" stroke="#22c55e" stroke-width="1"/>
  <text x="460" y="119" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#166534">I</text>
  <circle cx="460" cy="145" r="10" fill="#dcfce7" stroke="#22c55e" stroke-width="1"/>
  <text x="460" y="149" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#166534">I</text>
  <circle cx="500" cy="130" r="10" fill="#e5e7eb" stroke="#6b7280" stroke-width="1"/>

  <text x="335" y="175" font-family="Arial, sans-serif" font-size="9" fill="#dc2626">Spread probability:</text>
  <text x="335" y="190" font-family="monospace" font-size="8" fill="#dc2626">P = density * transmit * (1-immunity)</text>

  <text x="335" y="210" font-family="Arial, sans-serif" font-size="9" fill="#dc2626">Virulence cap: 0.8</text>
  <text x="335" y="225" font-family="Arial, sans-serif" font-size="9" fill="#22c55e">Recovery grants +30% immunity</text>
  <text x="335" y="245" font-family="Arial, sans-serif" font-size="9" fill="#dc2626">Status: emerging | epidemic | endemic</text>

  <!-- Catastrophe Section -->
  <rect x="560" y="55" width="250" height="200" rx="10" fill="white" stroke="#ea580c" stroke-width="2" filter="url(#shadowDyn)"/>
  <rect x="560" y="55" width="250" height="30" rx="10" fill="url(#catGrad)"/>
  <rect x="560" y="75" width="250" height="10" fill="url(#catGrad)"/>
  <text x="685" y="77" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Catastrophe System</text>

  <!-- Catastrophe types -->
  <text x="575" y="105" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#c2410c">Types:</text>
  <text x="585" y="120" font-family="monospace" font-size="8" fill="#c2410c">mass_extinction (10%)</text>
  <text x="585" y="133" font-family="monospace" font-size="8" fill="#c2410c">environmental_shift (30%)</text>
  <text x="585" y="146" font-family="monospace" font-size="8" fill="#c2410c">resource_crash (30%)</text>
  <text x="585" y="159" font-family="monospace" font-size="8" fill="#c2410c">epidemic (20%)</text>
  <text x="585" y="172" font-family="monospace" font-size="8" fill="#c2410c">cosmic_event (10%)</text>

  <text x="575" y="195" font-family="Arial, sans-serif" font-size="9" fill="#c2410c">Risk increases with:</text>
  <text x="585" y="210" font-family="monospace" font-size="8" fill="#c2410c">time_since_last * stress</text>
  <text x="575" y="230" font-family="Arial, sans-serif" font-size="9" fill="#c2410c">Severity cap: 0.7 (70% mortality max)</text>
  <text x="575" y="245" font-family="Arial, sans-serif" font-size="9" fill="#c2410c">Recovery: ~severity * 50 generations</text>

  <!-- Environmental Cycles Section -->
  <rect x="40" y="275" width="400" height="110" rx="10" fill="white" stroke="#8b5cf6" stroke-width="2" filter="url(#shadowDyn)"/>
  <rect x="40" y="275" width="400" height="30" rx="10" fill="url(#cycleGrad)"/>
  <rect x="40" y="295" width="400" height="10" fill="url(#cycleGrad)"/>
  <text x="240" y="297" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Environmental Cycles</text>

  <!-- Sine wave -->
  <path d="M60 350 Q90 320, 120 350 Q150 380, 180 350 Q210 320, 240 350 Q270 380, 300 350 Q330 320, 360 350 Q390 380, 420 350"
        stroke="#8b5cf6" stroke-width="2" fill="none"/>

  <!-- Phase labels -->
  <circle cx="90" cy="320" r="6" fill="#86efac"/>
  <text x="90" y="310" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#166534">Spring</text>
  <circle cx="180" cy="380" r="6" fill="#fef08a"/>
  <text x="180" y="390" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#ca8a04">Summer</text>
  <circle cx="270" cy="320" r="6" fill="#fdba74"/>
  <text x="270" y="310" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#c2410c">Autumn</text>
  <circle cx="360" cy="380" r="6" fill="#bfdbfe"/>
  <text x="360" y="390" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#1e40af">Winter</text>

  <text x="60" y="375" font-family="monospace" font-size="9" fill="#5b21b6">resource = base * (1 + amplitude * sin(2*pi*phase))</text>

  <!-- Niche Competition Section -->
  <rect x="460" y="275" width="350" height="110" rx="10" fill="white" stroke="#22c55e" stroke-width="2" filter="url(#shadowDyn)"/>
  <rect x="460" y="275" width="350" height="30" rx="10" fill="#22c55e"/>
  <rect x="460" y="295" width="350" height="10" fill="#22c55e"/>
  <text x="635" y="297" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Niche Competition</text>

  <!-- Niche circles -->
  <circle cx="520" cy="345" r="30" fill="#dcfce7" opacity="0.5" stroke="#22c55e" stroke-width="1"/>
  <text x="520" y="350" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#166534">Niche A</text>
  <circle cx="560" cy="355" r="30" fill="#dbeafe" opacity="0.5" stroke="#3b82f6" stroke-width="1"/>
  <text x="560" y="360" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#1e40af">Niche B</text>

  <circle cx="650" cy="345" r="25" fill="#dcfce7" opacity="0.5" stroke="#22c55e" stroke-width="1"/>
  <circle cx="680" cy="345" r="25" fill="#fee2e2" opacity="0.5" stroke="#ef4444" stroke-width="1"/>
  <circle cx="710" cy="345" r="25" fill="#fef3c7" opacity="0.5" stroke="#f59e0b" stroke-width="1"/>
  <text x="680" y="325" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">Low overlap</text>

  <text x="475" y="380" font-family="Arial, sans-serif" font-size="9" fill="#166534">High overlap = competition</text>
  <text x="620" y="380" font-family="Arial, sans-serif" font-size="9" fill="#166534">Low overlap = specialization</text>

  <!-- Control Flow Box -->
  <rect x="40" y="400" width="770" height="105" rx="8" fill="white" stroke="#cbd5e1" stroke-width="1"/>
  <text x="425" y="425" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1e293b">Ecological Control Loop (per generation)</text>

  <text x="60" y="450" font-family="Arial, sans-serif" font-size="10" fill="#334155">
    <tspan font-weight="bold">1.</tspan> Advance environmental cycle
  </text>
  <text x="60" y="470" font-family="Arial, sans-serif" font-size="10" fill="#334155">
    <tspan font-weight="bold">2.</tspan> Process resource regen/decay
  </text>
  <text x="60" y="490" font-family="Arial, sans-serif" font-size="10" fill="#334155">
    <tspan font-weight="bold">3.</tspan> Check catastrophe risk
  </text>
  <text x="290" y="450" font-family="Arial, sans-serif" font-size="10" fill="#334155">
    <tspan font-weight="bold">4.</tspan> Execute catastrophe (if triggered)
  </text>
  <text x="290" y="470" font-family="Arial, sans-serif" font-size="10" fill="#334155">
    <tspan font-weight="bold">5.</tspan> Spread diseases
  </text>
  <text x="290" y="490" font-family="Arial, sans-serif" font-size="10" fill="#334155">
    <tspan font-weight="bold">6.</tspan> Check disease emergence
  </text>
  <text x="560" y="450" font-family="Arial, sans-serif" font-size="10" fill="#334155">
    <tspan font-weight="bold">7.</tspan> Enforce carrying capacity
  </text>
  <text x="560" y="470" font-family="Arial, sans-serif" font-size="10" fill="#334155">
    <tspan font-weight="bold">8.</tspan> Trigger stress marks (epigenetics)
  </text>
  <text x="560" y="490" font-family="Arial, sans-serif" font-size="10" fill="#334155">
    <tspan font-weight="bold">9.</tspan> Emit ecological events
  </text>
</svg>
