<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 480">
  <defs>
    <linearGradient id="continueGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#22c55e"/>
      <stop offset="100%" style="stop-color:#16a34a"/>
    </linearGradient>
    <linearGradient id="throttleGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#f59e0b"/>
      <stop offset="100%" style="stop-color:#d97706"/>
    </linearGradient>
    <linearGradient id="pauseGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#ef4444"/>
      <stop offset="100%" style="stop-color:#dc2626"/>
    </linearGradient>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="800" height="480" fill="#f8fafc"/>

  <!-- Title -->
  <text x="400" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#1e293b">Resource Silo Adaptive Throttling</text>

  <!-- Pressure Bar Visualization -->
  <text x="400" y="75" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#475569">Memory Pressure Thresholds</text>

  <!-- Pressure bar background -->
  <rect x="80" y="95" width="640" height="45" rx="5" fill="#e2e8f0"/>

  <!-- Continue zone (0 - 0.7) -->
  <rect x="80" y="95" width="448" height="45" rx="5" fill="url(#continueGrad)"/>
  <text x="304" y="123" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">CONTINUE</text>

  <!-- Throttle zone (0.7 - 0.9) -->
  <rect x="528" y="95" width="128" height="45" fill="url(#throttleGrad)"/>
  <text x="592" y="123" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">THROTTLE</text>

  <!-- Pause zone (0.9 - 1.0) -->
  <rect x="656" y="95" width="64" height="45" rx="5" fill="url(#pauseGrad)"/>
  <text x="688" y="123" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">PAUSE</text>

  <!-- Threshold markers -->
  <line x1="528" y1="90" x2="528" y2="145" stroke="#475569" stroke-width="2" stroke-dasharray="4,2"/>
  <text x="528" y="160" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#475569">0.7 (high)</text>

  <line x1="656" y1="90" x2="656" y2="145" stroke="#475569" stroke-width="2" stroke-dasharray="4,2"/>
  <text x="656" y="160" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#475569">0.9 (critical)</text>

  <!-- Scale labels -->
  <text x="80" y="160" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#64748b">0%</text>
  <text x="720" y="160" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#64748b">100%</text>

  <!-- State Machine Diagram -->
  <text x="400" y="200" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#475569">State Transitions</text>

  <!-- Continue State -->
  <rect x="80" y="230" width="160" height="80" rx="10" fill="url(#continueGrad)" stroke="#16a34a" stroke-width="2"/>
  <text x="160" y="265" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">CONTINUE</text>
  <text x="160" y="285" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Base concurrency</text>
  <text x="160" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Normal operation</text>

  <!-- Throttle State -->
  <rect x="320" y="230" width="160" height="80" rx="10" fill="url(#throttleGrad)" stroke="#d97706" stroke-width="2"/>
  <text x="400" y="265" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">THROTTLE</text>
  <text x="400" y="285" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Reduced concurrency</text>
  <text x="400" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">May trigger GC</text>

  <!-- Pause State -->
  <rect x="560" y="230" width="160" height="80" rx="10" fill="url(#pauseGrad)" stroke="#dc2626" stroke-width="2"/>
  <text x="640" y="265" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">PAUSE</text>
  <text x="640" y="285" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Minimum concurrency</text>
  <text x="640" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Force GC, wait</text>

  <!-- Arrows between states -->
  <!-- Continue to Throttle -->
  <path d="M240 260 L310 260" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="275" y="250" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">mem &gt;= 0.7</text>

  <!-- Throttle to Pause -->
  <path d="M480 260 L550 260" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="515" y="250" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">mem &gt;= 0.9</text>

  <!-- Throttle back to Continue -->
  <path d="M310 280 L240 280" stroke="#22c55e" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="275" y="298" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#22c55e">mem &lt; 0.7</text>

  <!-- Pause back to Throttle -->
  <path d="M550 280 L480 280" stroke="#f59e0b" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="515" y="298" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#f59e0b">mem &lt; 0.9</text>

  <!-- Concurrency Formula Box -->
  <rect x="80" y="340" width="300" height="120" rx="8" fill="white" stroke="#7B68EE" stroke-width="2"/>
  <text x="230" y="365" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#5b21b6">L1 Concurrency Formula</text>

  <text x="95" y="390" font-family="monospace" font-size="10" fill="#334155">pressure_factor = (pressure - threshold)</text>
  <text x="95" y="405" font-family="monospace" font-size="10" fill="#334155">                  / (1.0 - threshold)</text>
  <text x="95" y="430" font-family="monospace" font-size="10" fill="#334155">scale = max(min_scale,</text>
  <text x="95" y="445" font-family="monospace" font-size="10" fill="#334155">        1.0 - factor * pressure_scale)</text>

  <!-- L2 Control Box -->
  <rect x="420" y="340" width="300" height="120" rx="8" fill="white" stroke="#0ea5e9" stroke-width="2"/>
  <text x="570" y="365" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#0369a1">L2-Controlled Parameters</text>

  <text x="435" y="390" font-family="Arial, sans-serif" font-size="11" fill="#0c4a6e">pressure_scale_factor: 0.5-0.99</text>
  <text x="435" y="410" font-family="Arial, sans-serif" font-size="11" fill="#0c4a6e">min_scale_factor: 0.1-0.5</text>
  <text x="435" y="430" font-family="Arial, sans-serif" font-size="11" fill="#0c4a6e">pressure_change_threshold: 0.01-0.1</text>
  <text x="435" y="450" font-family="Arial, sans-serif" font-size="11" fill="#0c4a6e">memory_high_threshold: 0.5-0.9</text>
</svg>
