<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
    <linearGradient id="serverGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#e3f2fd"/>
      <stop offset="100%" style="stop-color:#bbdefb"/>
    </linearGradient>
    <linearGradient id="moduleGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f3e5f5"/>
      <stop offset="100%" style="stop-color:#e1bee7"/>
    </linearGradient>
    <linearGradient id="evalGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#e8f5e9"/>
      <stop offset="100%" style="stop-color:#c8e6c9"/>
    </linearGradient>
    <linearGradient id="tweannGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#fff3e0"/>
      <stop offset="100%" style="stop-color:#ffe0b2"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.2"/>
    </filter>
  </defs>

  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#333">
    Faber Neuroevolution Architecture
  </text>

  <!-- Application Layer -->
  <rect x="50" y="50" width="700" height="100" rx="10" fill="none" stroke="#4caf50" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="70" y="75" font-family="Arial, sans-serif" font-size="12" fill="#4caf50" font-weight="bold">APPLICATION LAYER</text>

  <!-- Your Application -->
  <rect x="250" y="80" width="300" height="50" rx="8" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" filter="url(#shadow)"/>
  <text x="400" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2e7d32">Your Application</text>
  <text x="400" y="120" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">(Snake Game, Robot Controller, etc.)</text>

  <!-- Neuroevolution Layer -->
  <rect x="50" y="170" width="700" height="200" rx="10" fill="none" stroke="#1976d2" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="70" y="195" font-family="Arial, sans-serif" font-size="12" fill="#1976d2" font-weight="bold">NEUROEVOLUTION LAYER (faber_neuroevolution)</text>

  <!-- Server -->
  <rect x="300" y="210" width="200" height="70" rx="8" fill="url(#serverGrad)" stroke="#1976d2" stroke-width="2" filter="url(#shadow)"/>
  <text x="400" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1565c0">neuroevolution_server</text>
  <text x="400" y="255" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">gen_server</text>
  <text x="400" y="270" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#999">Population management</text>

  <!-- Selection module -->
  <rect x="70" y="300" width="140" height="55" rx="8" fill="url(#moduleGrad)" stroke="#9c27b0" stroke-width="2" filter="url(#shadow)"/>
  <text x="140" y="325" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#7b1fa2">selection</text>
  <text x="140" y="342" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">Top-N%, tournament</text>

  <!-- Genetic module -->
  <rect x="230" y="300" width="140" height="55" rx="8" fill="url(#moduleGrad)" stroke="#9c27b0" stroke-width="2" filter="url(#shadow)"/>
  <text x="300" y="325" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#7b1fa2">genetic</text>
  <text x="300" y="342" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">Crossover, mutation</text>

  <!-- Evaluator behaviour -->
  <rect x="430" y="300" width="140" height="55" rx="8" fill="url(#evalGrad)" stroke="#4caf50" stroke-width="2" filter="url(#shadow)"/>
  <text x="500" y="325" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2e7d32">evaluator</text>
  <text x="500" y="342" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">behaviour</text>

  <!-- Speciation module -->
  <rect x="590" y="300" width="140" height="55" rx="8" fill="url(#moduleGrad)" stroke="#9c27b0" stroke-width="2" filter="url(#shadow)"/>
  <text x="660" y="325" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#7b1fa2">speciation</text>
  <text x="660" y="342" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">Diversity protection</text>

  <!-- TWEANN Layer -->
  <rect x="50" y="390" width="700" height="100" rx="10" fill="none" stroke="#f57c00" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="70" y="415" font-family="Arial, sans-serif" font-size="12" fill="#f57c00" font-weight="bold">NETWORK LAYER (faber_tweann)</text>

  <!-- network_evaluator -->
  <rect x="150" y="430" width="180" height="45" rx="8" fill="url(#tweannGrad)" stroke="#f57c00" stroke-width="2" filter="url(#shadow)"/>
  <text x="240" y="455" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#e65100">network_evaluator</text>
  <text x="240" y="468" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">Forward propagation</text>

  <!-- network_onnx -->
  <rect x="470" y="430" width="180" height="45" rx="8" fill="url(#tweannGrad)" stroke="#f57c00" stroke-width="2" filter="url(#shadow)"/>
  <text x="560" y="455" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#e65100">network_onnx</text>
  <text x="560" y="468" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">Export for inference</text>

  <!-- Arrows -->
  <!-- App to Server -->
  <line x1="400" y1="130" x2="400" y2="208" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="410" y="170" font-family="Arial, sans-serif" font-size="10" fill="#666">start_training()</text>

  <!-- Server to modules -->
  <line x1="300" y1="270" x2="210" y2="298" stroke="#666" stroke-width="1.5" marker-end="url(#arrowhead)"/>
  <line x1="350" y1="280" x2="300" y2="298" stroke="#666" stroke-width="1.5" marker-end="url(#arrowhead)"/>
  <line x1="450" y1="280" x2="500" y2="298" stroke="#666" stroke-width="1.5" marker-end="url(#arrowhead)"/>
  <line x1="500" y1="270" x2="590" y2="298" stroke="#666" stroke-width="1.5" marker-end="url(#arrowhead)"/>

  <!-- Evaluator to tweann -->
  <line x1="500" y1="355" x2="400" y2="428" stroke="#666" stroke-width="1.5" marker-end="url(#arrowhead)"/>
  <text x="420" y="395" font-family="Arial, sans-serif" font-size="10" fill="#666">evaluate()</text>

  <!-- Legend -->
  <rect x="50" y="510" width="700" height="40" fill="#f5f5f5" rx="5"/>
  <rect x="70" y="525" width="20" height="15" fill="url(#serverGrad)" stroke="#1976d2"/>
  <text x="100" y="537" font-family="Arial, sans-serif" font-size="10" fill="#333">Server (gen_server)</text>
  <rect x="220" y="525" width="20" height="15" fill="url(#moduleGrad)" stroke="#9c27b0"/>
  <text x="250" y="537" font-family="Arial, sans-serif" font-size="10" fill="#333">Core modules</text>
  <rect x="360" y="525" width="20" height="15" fill="url(#evalGrad)" stroke="#4caf50"/>
  <text x="390" y="537" font-family="Arial, sans-serif" font-size="10" fill="#333">Behaviour</text>
  <rect x="480" y="525" width="20" height="15" fill="url(#tweannGrad)" stroke="#f57c00"/>
  <text x="510" y="537" font-family="Arial, sans-serif" font-size="10" fill="#333">faber_tweann</text>
</svg>
