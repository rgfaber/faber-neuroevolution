<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 750 400" width="750" height="400">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#4a5568"/>
    </marker>
    <linearGradient id="robotGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#48bb78;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#38a169;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="trainerGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#9f7aea;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#805ad5;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="dhtGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#4299e1;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#3182ce;stop-opacity:1" />
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="750" height="400" fill="#f7fafc" rx="8"/>

  <!-- Title -->
  <text x="375" y="25" text-anchor="middle" fill="#2d3748" font-family="sans-serif" font-size="14" font-weight="bold">Swarm Architecture on Macula Mesh</text>

  <!-- Main mesh container -->
  <rect x="20" y="40" width="710" height="280" rx="8" fill="#f0fff4" stroke="#48bb78" stroke-width="2"/>
  <text x="40" y="62" fill="#276749" font-family="sans-serif" font-size="11" font-weight="bold">MACULA MESH</text>

  <!-- Robot nodes -->
  <rect x="50" y="80" width="90" height="55" rx="6" fill="url(#robotGrad)" stroke="#276749" stroke-width="2"/>
  <text x="95" y="100" text-anchor="middle" fill="white" font-family="monospace" font-size="10" font-weight="bold">Robot 1</text>
  <text x="95" y="118" text-anchor="middle" fill="#c6f6d5" font-family="monospace" font-size="8">(peer)</text>

  <rect x="170" y="80" width="90" height="55" rx="6" fill="url(#robotGrad)" stroke="#276749" stroke-width="2"/>
  <text x="215" y="100" text-anchor="middle" fill="white" font-family="monospace" font-size="10" font-weight="bold">Robot 2</text>
  <text x="215" y="118" text-anchor="middle" fill="#c6f6d5" font-family="monospace" font-size="8">(peer)</text>

  <rect x="290" y="80" width="90" height="55" rx="6" fill="url(#robotGrad)" stroke="#276749" stroke-width="2"/>
  <text x="335" y="100" text-anchor="middle" fill="white" font-family="monospace" font-size="10" font-weight="bold">Robot 3</text>
  <text x="335" y="118" text-anchor="middle" fill="#c6f6d5" font-family="monospace" font-size="8">(peer)</text>

  <rect x="410" y="80" width="90" height="55" rx="6" fill="url(#robotGrad)" stroke="#276749" stroke-width="2"/>
  <text x="455" y="100" text-anchor="middle" fill="white" font-family="monospace" font-size="10" font-weight="bold">Robot N</text>
  <text x="455" y="118" text-anchor="middle" fill="#c6f6d5" font-family="monospace" font-size="8">(peer)</text>

  <!-- Trainer node -->
  <rect x="530" y="80" width="90" height="55" rx="6" fill="url(#trainerGrad)" stroke="#6b46c1" stroke-width="2"/>
  <text x="575" y="100" text-anchor="middle" fill="white" font-family="monospace" font-size="10" font-weight="bold">Trainer</text>
  <text x="575" y="118" text-anchor="middle" fill="#e9d8fd" font-family="monospace" font-size="8">(peer)</text>

  <!-- Mesh connections (bidirectional) -->
  <line x1="140" y1="107" x2="170" y2="107" stroke="#4a5568" stroke-width="2"/>
  <line x1="260" y1="107" x2="290" y2="107" stroke="#4a5568" stroke-width="2"/>
  <line x1="380" y1="107" x2="410" y2="107" stroke="#4a5568" stroke-width="2"/>
  <line x1="500" y1="107" x2="530" y2="107" stroke="#4a5568" stroke-width="2"/>

  <!-- Vertical connections to bus -->
  <line x1="95" y1="135" x2="95" y2="165" stroke="#4a5568" stroke-width="1"/>
  <line x1="215" y1="135" x2="215" y2="165" stroke="#4a5568" stroke-width="1"/>
  <line x1="335" y1="135" x2="335" y2="165" stroke="#4a5568" stroke-width="1"/>
  <line x1="455" y1="135" x2="455" y2="165" stroke="#4a5568" stroke-width="1"/>
  <line x1="575" y1="135" x2="575" y2="165" stroke="#4a5568" stroke-width="1"/>

  <!-- Horizontal bus line -->
  <line x1="95" y1="165" x2="575" y2="165" stroke="#4a5568" stroke-width="2"/>

  <!-- Arrow down to DHT -->
  <line x1="335" y1="165" x2="335" y2="200" stroke="#4a5568" stroke-width="2" marker-end="url(#arrowhead)"/>

  <!-- DHT Box -->
  <rect x="150" y="210" width="370" height="95" rx="6" fill="url(#dhtGrad)" stroke="#2b6cb0" stroke-width="2"/>
  <text x="335" y="235" text-anchor="middle" fill="white" font-family="monospace" font-size="12" font-weight="bold">DHT (Service Discovery)</text>
  <text x="180" y="258" fill="#bee3f8" font-family="monospace" font-size="9">- Robot locations</text>
  <text x="180" y="275" fill="#bee3f8" font-family="monospace" font-size="9">- Network versions</text>
  <text x="180" y="292" fill="#bee3f8" font-family="monospace" font-size="9">- Task assignments</text>
  <text x="350" y="258" fill="#bee3f8" font-family="monospace" font-size="9">- Pheromone trails</text>
  <text x="350" y="275" fill="#bee3f8" font-family="monospace" font-size="9">- Swarm state</text>
  <text x="350" y="292" fill="#bee3f8" font-family="monospace" font-size="9">- Fitness reports</text>

  <!-- Legend -->
  <rect x="30" y="340" width="690" height="45" rx="6" fill="#edf2f7" stroke="#cbd5e0"/>
  <rect x="50" y="355" width="12" height="12" rx="2" fill="#48bb78"/>
  <text x="70" y="365" fill="#4a5568" font-family="monospace" font-size="9">Robot (evolved brain)</text>
  <rect x="200" y="355" width="12" height="12" rx="2" fill="#9f7aea"/>
  <text x="220" y="365" fill="#4a5568" font-family="monospace" font-size="9">Trainer (evolution coordinator)</text>
  <rect x="400" y="355" width="12" height="12" rx="2" fill="#4299e1"/>
  <text x="420" y="365" fill="#4a5568" font-family="monospace" font-size="9">DHT (distributed state)</text>
  <line x1="570" y1="361" x2="600" y2="361" stroke="#4a5568" stroke-width="2"/>
  <text x="610" y="365" fill="#4a5568" font-family="monospace" font-size="9">P2P mesh link</text>
</svg>